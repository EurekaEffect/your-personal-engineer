// ==UserScript==
// @name            Your Personal Engineer
// @description     Makes your trading routine more comfortable.
// @author          https://steamcommunity.com/id/EurekaEffect/
// @version         1.2

// @updateURL       https://github.com/EurekaEffect/your-personal-engineer/raw/refs/heads/master/output/ype.bundle.user.js
// @downloadURL     https://github.com/EurekaEffect/your-personal-engineer/raw/refs/heads/master/output/ype.bundle.user.js

// @match           *://backpack.tf/stats/*
// @match           *://backpack.tf/classifieds*
// @match           *://steamcommunity.com/tradeoffer/new*

// @run-at          document-idle
// ==/UserScript==
(()=>{"use strict";var e={551:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isClassifiedsUrl=function(e){return/^https:\/\/backpack\.tf\/classifieds\?.+$|^https:\/\/backpack\.tf\/stats\/.+$/.test(e)},t.mainClassifieds=function(){return n(this,void 0,void 0,(function*(){document.querySelector("head").insertAdjacentHTML("afterend",r);const e=document.querySelectorAll(".listing");for(const t of e){const e=t.querySelector(".item"),n=t.querySelector(".listing-buttons");if(!e.getAttribute("data-listing_price"))continue;if("buy"===e.getAttribute("data-listing_intent"))continue;const r=i(t);if(r){n.insertAdjacentHTML("beforeend",o);const i=t.querySelector(".btn.btn-bottom.btn-xs.btn-success.hover-able"),a=i.querySelector(".popup-panel");i.addEventListener("mouseenter",(()=>{a.style.display="block"})),a.addEventListener("mouseleave",(()=>{a.style.display="none"}));let c=t.querySelector(".fa.fa-sw.fa-flash");c?c=c.cloneNode(!0):(c=document.createElement("i"),c.classList.add("fa","fa-sw","fa-exchange")),i.prepend(c),i.addEventListener("click",(()=>{let t=e.getAttribute("data-id"),n=e.getAttribute("data-name"),o=e.getAttribute("data-listing_intent"),a=i.getAttribute("ype.amount");const c=s(e.getAttribute("data-listing_price")),l={asset_id:t&&0!==t.length?t:void 0,item_name:n,intent:o,amount:a,currencies:c},u=`${r}&ype=${JSON.stringify(l)}`;open(u,"_blank")}))}}}))};const r='<style>\n        .hover-able {\n            cursor: pointer;\n            position: relative;\n            display: inline-block;\n            z-index: 1;\n        }\n\n        .popup-panel {\n            position:absolute;\n            top: -43px;\n            left: 50%;\n            width: 125px;\n            transform: translateX(-50%);\n            display:none;\n            z-index:1070;\n            background-color: black;\n            color: white;\n            font-family:"Helvetica Neue",Roboto,Arial,sans-serif;\n            font-size:12px;\n            font-weight:400;\n            line-height:1.4;\n            opacity: 0.9;\n            margin-top:-3px;\n            padding:5px 5px;\n            border-radius: 5px;\n        }\n        \n        output {\n            color: white; \n            margin: -5px\n        }\n    </style>',o='<a class="btn btn-bottom btn-xs btn-success hover-able" style="background-color: rgb(185, 143, 200); border-color: rgb(185, 143, 200)" ype.amount="1">\n        <div class="popup-panel" onclick="event.stopPropagation()">\n            <input type="range" value="1" min="1" max="50" oninput="this.nextElementSibling.value = this.value; this.parentNode.parentNode.setAttribute(\'ype.amount\', parseInt(this.value))" draggable="false">\n            <output>1</output>\n        </div>\n    </a>';function i(e){const t=e.querySelector(".user-link").getAttribute("data-offers-params");return t?`https://steamcommunity.com/tradeoffer/new/${t}`:void 0}function s(e){const t=/\b(\d+(\.\d+)?)\s(key|keys|ref|refs)\b/g;function n(e){const t={},n=e[1];let r=e[3];return"key"!==r&&"keys"!==r||(r="keys"),"ref"!==r&&"refs"!==r||(r="metal"),t[r]=parseFloat(n),t}const r={};let o;for(;null!==(o=t.exec(e));){const e=n(o);Object.assign(r,e)}return r.keys||(r.keys=0),r.metal||(r.metal=0),r}},279:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.alert=function(e){window.alert(`Script: Your Personal Engineer\n${e}`)},t.log=function(e,t){console.log(`[YPE, ${e}] ${t}`)},t.error=function(e,t){console.error(`[YPE, ${e}] ${t}`)},t.throwError=function(e){throw Error(e)},t.getWindow=function(){return unsafeWindow};const o=n(849),i=n(551);!function(){r(this,void 0,void 0,(function*(){const e=(0,o.isTradeOfferUrl)(location.href),t=(0,i.isClassifiedsUrl)(location.href);e?yield(0,o.mainTradeOffer)():t&&(yield(0,i.mainClassifieds)())}))}()},849:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isTradeOfferUrl=function(e){return/^https:\/\/steamcommunity\.com\/tradeoffer\/new\/\?partner=\d+&token=.+$/.test(e)},t.mainTradeOffer=function(){return r(this,void 0,void 0,(function*(){const e=new d;!function(){function e(e,t){let n=(0,o.getWindow)().CTradeOfferStateManager[e];(0,o.getWindow)().CTradeOfferStateManager[e]=function r(i,s,a){(0,o.getWindow)().CTradeOfferStateManager[e]=n,(0,o.getWindow)().CTradeOfferStateManager[e](i,s,a),n=(0,o.getWindow)().CTradeOfferStateManager[e],(0,o.getWindow)().CTradeOfferStateManager[e]=r;const c=new CustomEvent("item_interaction",{detail:{user:i.is_their_item?"UserThem":"UserYou",item:i,type:t}});window.dispatchEvent(c)}}function t(e,t){const n=document.querySelector(`#${e}`);null==n||n.addEventListener("click",(()=>{(0,o.getWindow)().SelectInventoryFromUser((0,o.getWindow)()[t],440,2,!1);const e=(0,o.getWindow)()[t]===(0,o.getWindow)().UserThem,n=new CustomEvent("inventory_selected",{detail:{user:e?"UserThem":"UserYou"}});window.dispatchEvent(n)}))}e("SetItemInTrade","added"),e("RemoveItemFromTrade","removed"),t("inventory_select_your_inventory","UserYou"),t("inventory_select_their_inventory","UserThem")}(),u("UserYou"),u("UserThem"),window.addEventListener("inventory_load_complete",(t=>r(this,void 0,void 0,(function*(){const n=t.detail.user,r="UserYou"===n,i="UserThem"===n;if((0,o.log)("Main.inventory_load_complete",`${n} inventory was loaded.`),r&&(s=!0,e.updateCurrencies(n)),i&&(a=!0),s&&a){const e=new CustomEvent("both_inventories_loaded");window.dispatchEvent(e)}})))),window.addEventListener("both_inventories_loaded",(()=>r(this,void 0,void 0,(function*(){const e=new URLSearchParams(location.search).get("ype"),t=e?JSON.parse(e):{};let{asset_id:n,item_name:r,intent:s,amount:a,currencies:l}=t;if(!e)return;if(!s){const e="Missing parameters: 'intent'.";(0,o.alert)(e),(0,o.throwError)(e)}const u=[],d=[];if("sell"===s){if(!n||!a||!l){const e="Missing parameters: 'asset_id', 'amount' or 'currencies'.";(0,o.alert)(e),(0,o.throwError)(e)}if(d){const e=(0,i.getRgItemByAssetId)("UserThem",n);if(e&&d.push(e),!r){const e="Missing parameters: 'item_name'.";(0,o.alert)(e),(0,o.throwError)(e)}let t=(0,i.getRgItemsByName)("UserThem",r);if(e&&(t=t.filter((e=>e.id!=n))),t=t.slice(0,a-d.length),d.push(...t),0===d.length){const e="Item('s) has already been sold.";(0,o.alert)(e),(0,o.throwError)(e)}}if(u){let e=Math.round(l.metal/.05555555555555555);const t=d.length;for(;d.length>0;){let n=d.length;const r=c(s,l.keys*n,e*n/18);if(""===r.error_message){const e=a-t,n=d.length;e>0&&n<t?(0,o.alert)(`${t} out of ${a} items were found,\nand only ${n} out of ${t} are adjusted to your available currency.\nAdding ${n} items to the trade offer...`):e>0?(0,o.alert)(`${t} out of ${a} items were found,\nAdding ${n} items to the trade offer...`):n<t&&(0,o.alert)(`${n} out of ${t} are adjusted to your available currency.\nAdding ${n} items to the trade offer...`),u.push(...r.rg_items_to_give),d.push(...r.rg_items_to_receive);break}d.pop(),0===d.length&&((0,o.alert)(r.error_message),(0,o.throwError)(r.error_message))}}}else(0,o.alert)("buy, not implemented.");const m=u.map((e=>e.id)),f=d.map((e=>e.id));(0,i.SetItemsInTrade)(m),(0,i.SetItemsInTrade)(f)})))),window.addEventListener("item_interaction",(t=>{const n=t.detail.user;t.detail.item,e.updateCurrencies(n)})),window.addEventListener("inventory_selected",(t=>{const n=t.detail.user;e.updateCurrencies(n)}))}))};const o=n(279),i=n(373);let s=!1,a=!1;function c(e,t,n){const r={rg_items_to_give:[],rg_items_to_receive:[],error_message:""},o=function(e,t){let n=Math.round(t/.05555555555555555),r=Math.floor(n/18);n-=18*r;let o=Math.floor(n/6);n-=6*o;let i=Math.floor(n/2);return n-=2*i,{key_amount:e,refined_amount:r,reclaimed_amount:o,scrap_amount:i}}(t,n);if("sell"===e){const[e,t,n]=l("UserYou",o);if(Object.values(t).find((e=>0!==e))||n){const[e,n,o]=l("UserThem",t);if(Object.values(n).find((e=>0!==e))||o)return r.error_message="Could not balance currencies.",r;for(let t of e)r.rg_items_to_receive.push(t)}for(let t of e)r.rg_items_to_give.push(t)}else{const[e,t]=l("UserThem",o);if(Object.values(t).find((e=>0!==e))){const[e,n]=l("UserYou",t);if(Object.values(n).find((e=>0!==e)))return r.error_message="Could not balance currencies.",r;for(let t of e)r.rg_items_to_give.push(t)}for(let t of e)r.rg_items_to_receive.push(t)}return r}function l(e,t){const n=(0,i.getRgItems)(e);let{key_amount:r,refined_amount:o,reclaimed_amount:s,scrap_amount:a}=t;const c=n.filter((e=>"Mann Co. Supply Crate Key"===e.name)),l=n.filter((e=>"Refined Metal"===e.name)),u=n.filter((e=>"Reclaimed Metal"===e.name)),d=n.filter((e=>"Scrap Metal"===e.name));if(c.length<r)return[[],[],"Insufficient keys."];if(l.length+u.length/3+d.length/9<o+s/3+a/9)return[[],[],"Insufficient metal."];let m=l.length-o,f=u.length-s,h=d.length-a,g={key_amount:0,refined_amount:0,reclaimed_amount:0,scrap_amount:0};for(h<0&&(h=-h,s+=Math.ceil(h/3),f-=Math.ceil(h/3),g.scrap_amount+=3-h%3,g.scrap_amount%=3,a-=h,h=0),f<0&&(f=-f,o+=Math.ceil(f/3),m-=Math.ceil(f/3),g.reclaimed_amount+=3-f%3,g.reclaimed_amount%=3,s-=f,f=0);m<0;){if(!(f>=3*-m))return[[],[],"Could not balance currencies."];o-=-m,s+=3*-m,f-=3*-m,m=0}if(0!=o&&0!=g.refined_amount){let e=Math.min(o,g.refined_amount);o-=e,g.refined_amount-=e}if(0!=s&&0!=g.reclaimed_amount){let e=Math.min(s,g.reclaimed_amount);s-=e,g.reclaimed_amount-=e}if(0!=a&&0!=g.scrap_amount){let e=Math.min(a,g.scrap_amount);a-=e,g.scrap_amount-=e}const y=Math.floor(Math.random()*(c.length-r+1)),p=Math.floor(Math.random()*(l.length-o+1)),v=Math.floor(Math.random()*(u.length-s+1)),w=Math.floor(Math.random()*(d.length-a+1)),_=c.slice(y,y+r),I=l.slice(p,p+o),b=u.slice(v,v+s),x=d.slice(w,w+a);let k=_;return k=k.concat(I),k=k.concat(b),k=k.concat(x),r<0||o<0||s<0||a<0||g.refined_amount<0||g.reclaimed_amount<0||g.scrap_amount<0||y<0||p<0||v<0||w<0||null==r||null==o||null==s||null==a||r>c.length||o>l.length||s>u.length||a>d.length||k.length<r||_.length!=r||I.length!=o||b.length!=s||x.length!=a?(console.log("Something went wrong balancing currencies:"),console.log([c.length,l.length,u.length,d.length,r,o,s,a,y,p,v,w,_,I,b,x,JSON.stringify(k,void 0,4)].join("\n")),[[],[],"Could not balance currencies."]):[k,g]}function u(e){const t="UserThem"===e;if("UserYou"!==e&&!t)return(0,o.error)("[YPE, Main.loadInventory]",`Unknown user '${e}'.`);t&&(0,o.getWindow)()[e].loadInventory(440,2);const n=(0,o.getWindow)()[e].OnLoadInventoryComplete;(0,o.getWindow)()[e].OnLoadInventoryComplete=function(r,i,s){(0,o.getWindow)()[e].OnLoadInventoryComplete=n,(0,o.getWindow)()[e].OnLoadInventoryComplete(r,i,s);const a=(0,o.getWindow)()[e].getInventory(440,2);t&&(a.Initialize(),a.MakeActive(),(0,o.getWindow)().g_ActiveInventory=a,(0,o.getWindow)().g_ActiveInventory.hide(),(0,o.getWindow)().SelectInventoryFromUser((0,o.getWindow)().UserYou,440,2,!1));const c=new CustomEvent("inventory_load_complete",{detail:{user:e,inventory:a}});window.dispatchEvent(c)}}class d{constructor(){var e,t;this.items=new m;const n=document.querySelector(".trade_right.selectableNone");null==n||n.insertAdjacentHTML("afterbegin",'<div id="currency-panel" class="your_items">\n    <div class="trade_box_bgheader active"></div>\n    <div class="trade_box_contents" style="background: #1D1D1D">\n        <div id="warning-text" class="tutorial_arrow_ctn" style="text-align: center; color: #d83636"></div>\n        <div class="tutorial_arrow_ctn" style="display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-around; align-items: stretch; align-content: stretch;">\n            <div style="position: relative; text-align: center; color: white"><img src="https://community.cloudflare.steamstatic.com/economy/image/fWFc82js0fmoRAP-qOIPu5THSWqfSmTELLqcUywGkijVjZULUrsm1j-9xgEAaR4uURrwvz0N252yVaDVWrRTno9m4ccG2GNqxlQoZrC2aG9hcVGUWflbX_drrVu5UGki5sAij6tOtQ/96fx96f"><div id="key-count" style="position: absolute; bottom: 10px; right: 10px">0x</div></div>\n            <div style="position: relative; text-align: center; color: white"><img src="https://community.cloudflare.steamstatic.com/economy/image/fWFc82js0fmoRAP-qOIPu5THSWqfSmTELLqcUywGkijVjZULUrsm1j-9xgEbZQsUYhTkhzJWhsO1Mv6NGucF1Ygzt8ZQijJukFMiMrbhYDEwI1yRVKNfD6xorQ3qW3Jr6546DNPuou9IOVK4p4kWJaA/96fx96f"><div id="ref-count" style="position: absolute; bottom: 10px; right: 10px">0x</div></div>\n            <div style="position: relative; text-align: center; color: white"><img src="https://community.cloudflare.steamstatic.com/economy/image/fWFc82js0fmoRAP-qOIPu5THSWqfSmTELLqcUywGkijVjZULUrsm1j-9xgEbZQsUYhTkhzJWhsO0Mv6NGucF1YJlscMEgDdvxVYsMLPkMmFjI1OSUvMHDPBp9lu0CnVluZQxA9Gwp-hIOVK4sMMNWF4/96fx96f"><div id="rec-count" style="position: absolute; bottom: 10px; right: 10px">0x</div></div>\n            <div style="position: relative; text-align: center; color: white"><img src="https://community.cloudflare.steamstatic.com/economy/image/fWFc82js0fmoRAP-qOIPu5THSWqfSmTELLqcUywGkijVjZULUrsm1j-9xgEbZQsUYhTkhzJWhsPZAfOeD-VOn4phtsdQ32ZtxFYoN7PkYmVmIgeaUKNaX_Rjpwy8UHMz6pcxAIfnovUWJ1t9nYFqYw/96fx96f"><div id="scrap-count" style="position: absolute; bottom: 10px; right: 10px">0x</div></div>\n        </div>\n        <div style="display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-around; align-items: stretch; align-content: stretch;" class="tutorial_arrow_ctn">\n            <input id="keys" placeholder="Keys" class="filter_search_box" type="number">\n            <input id="metal" placeholder="Metal" class="filter_search_box" type="number">\n            <a id="add-currency" class="pagecontrol_element pagebtn">Add</a>\n        </div>\n    </div>\n</div>'),null===(t=null===(e=this.get())||void 0===e?void 0:e.querySelector("#add-currency"))||void 0===t||t.addEventListener("click",(()=>r(this,void 0,void 0,(function*(){var e;const t=document.querySelector("#keys"),n=document.querySelector("#metal");if(!t||!n)return(0,o.throwError)("Cannot find 'keys' or 'metal' element.");const r=t.value?parseInt(t.value):0;let s=n.value?parseFloat(n.value):0;if(isNaN(r)||isNaN(s))return(0,o.alert)("Only numbers are allowed in 'keys' and 'metal' textboxes."),(0,o.throwError)("Only numbers are allowed in 'keys' and 'metal' textboxes.");if(r<0||s<0)return(0,o.alert)("Only non-negative numbers are allowed in 'keys' and 'metal' textboxes."),(0,o.throwError)("Only non-negative numbers are allowed in 'keys' and 'metal' textboxes.");const a=(0,o.getWindow)().g_ActiveUser===(0,o.getWindow)().UserThem?"UserThem":"UserYou",c=this.items.getCurrenciesInInventory(a);let l=Math.round(s/.05555555555555555),u=Math.floor(l/18);u=Math.min(c.ref.length,u),l-=18*u;let d=Math.floor(l/6);d=Math.min(c.rec.length,d),l-=6*d;let m=Math.floor(l/2);if(m=Math.min(c.scrap.length,m),l-=2*m,r>c.key.length||l>0){const e=0===r?0:r-c.key.length,t=Math.floor(l/18*100)/100;e&&t?this.showWarning(`You are missing ${e} keys ${t} metal.`):e?this.showWarning(`You are missing ${e} keys.`):this.showWarning(`You are missing ${t} metal.`)}else{this.hideWarning();const t=[...c.key.slice(0,r),...c.ref.slice(0,u),...c.rec.slice(0,d),...c.scrap.slice(0,m)].map((e=>e.id)),n=null===(e=this.get())||void 0===e?void 0:e.querySelector("#add-currency");null==n||n.classList.add("disabled"),yield(0,i.SetItemsInTrade)(t),null==n||n.classList.remove("disabled"),this.updateCurrencies(a)}}))))}get(){return document.querySelector("#currency-panel")}showWarning(e){document.querySelector("#warning-text").textContent=e}hideWarning(){document.querySelector("#warning-text").textContent=""}updateCurrencies(e){const t=this.items.getCurrenciesInInventory(e);this.updateCurrency("key-count",t.key.length),this.updateCurrency("ref-count",t.ref.length),this.updateCurrency("rec-count",t.rec.length),this.updateCurrency("scrap-count",t.scrap.length)}updateCurrency(e,t){["key-count","ref-count","rec-count","scrap-count"].includes(e)||(0,o.throwError)(`Item id '${e}' is not valid.`);const n=document.querySelector(`#${e}`);n?(n.parentNode.style.opacity=t>0?"100%":"40%",n.textContent=`${t}x`):(0,o.throwError)(`Element '${e}' was not found.`)}getItems(){return this.items}updateCurrencyPanelInfoAndClick(e,t){const n=document.querySelector("#keys"),r=document.querySelector("#metal"),o=document.querySelector("#add-currency");n.value=e,r.value=t,o.click()}}class m{constructor(){this.class_ids={key:"101785959",ref:"2674",rec:"5564",scrap:"2675"}}getCurrenciesInInventory(e){return{key:this.getItemsByClassId(e,this.class_ids.key),ref:this.getItemsByClassId(e,this.class_ids.ref),rec:this.getItemsByClassId(e,this.class_ids.rec),scrap:this.getItemsByClassId(e,this.class_ids.scrap)}}getItemsByClassId(e,t){"UserYou"===e||"UserThem"===e||(0,o.throwError)(`Unknown user '${e}'.`);const n=(0,o.getWindow)()[e].getInventory(440,2).rgInventory,r=[];for(let e in n){const i=n[e],s=i.element;(0,o.getWindow)().BIsInTradeSlot(s)||i.classid===t&&r.push(i)}return r}}},373:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SetItemsInTrade=function(e){return r(this,void 0,void 0,(function*(){return new Promise((t=>r(this,void 0,void 0,(function*(){const n=(0,o.getWindow)().CTradeOfferStateManager;for(let t of e){const e=document.querySelector(`#item440_2_${t}`);if(e){const r=e.rgItem;(0,o.getWindow)().BIsInTradeSlot(r)?(alert(`Item with id '${t}' is already in a trade slot.`),(0,o.error)("TradeOffer.SetItemsInTrade",`Item with id '${t}' is already in a trade slot.`)):yield new Promise((e=>{setTimeout((()=>{n.SetItemInTrade(r,0,1),e(!0)}),1)}))}else alert(`Item with id '${t}' not found.`),(0,o.error)("TradeOffer.SetItemsInTrade",`Item with id '${t}' not found.`)}t(e)}))))}))},t.SetItemInTrade=function(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>r(this,void 0,void 0,(function*(){const r=document.querySelector(`#item440_2_${e}`);if(r){const i=r.rgItem;(0,o.getWindow)().BIsInTradeSlot(i)?n(`Item with id '${e}' is already in a trade slot.`):(yield new Promise((e=>{setTimeout((()=>{(0,o.getWindow)().CTradeOfferStateManager.SetItemInTrade(i,0,1),e(!0)}),1)})),t(!0))}else n(`Item with id '${e}' not found.`);t(!1)}))))}))},t.getRgItemsByName=function(e,t){"UserYou"===e||"UserThem"===e||(0,o.throwError)(`Unknown user '${e}'.`);const n=(0,o.getWindow)()[e].getInventory(440,2).rgInventory,r=[];for(let e in n){const i=n[e],s=i.market_name;(0,o.getWindow)().BIsInTradeSlot(i)||s===t&&r.push(i)}return r},t.getRgItemByAssetId=function(e,t){"UserYou"===e||"UserThem"===e||(0,o.throwError)(`Unknown user '${e}'.`);const n=(0,o.getWindow)()[e].getInventory(440,2).rgInventory;for(let e in n){const r=n[e];if(!(0,o.getWindow)().BIsInTradeSlot(r)&&e===t)return r}},t.removeItemFromTradeOffer=function(e){},t.refreshTradeStatus=function(){(0,o.getWindow)().RefreshTradeStatus((0,o.getWindow)().g_rgCurrentTradeStatus)},t.getRgItems=function(e){return Object.values((0,o.getWindow)()[e].getInventory(440,2).rgInventory)};const o=n(279)}},t={};!function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(279)})();